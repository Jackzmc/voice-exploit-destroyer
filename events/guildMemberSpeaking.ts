import { GuildMember, Speaking } from 'discord.js';
import Event from '../src/types/Event.js'

const MONITOR_CHANNELS = [
    "137389758228725762"
]

let pendingDisconnect: {[id: string]: boolean} = {};

export default class extends Event {
    async before() {
        return false;
    }
    after(member: GuildMember, speaking: Speaking) {
        const pending = pendingDisconnect[member.id]
        if(MONITOR_CHANNELS.includes(member.voice.channelID) && member.voice?.selfMute) {
            if(pending) {
                member.voice.kick('Bitch.')
                delete pendingDisconnect[member.id]
            }else{
                pendingDisconnect[member.id] = true
            }
        }else if(pending) {
            delete pendingDisconnect[member.id]
        }
    }
}